= Build Your First Remote MCP Server
:description: Learn how to extend AI agents with custom tools that interact with your Redpanda data using the Model Context Protocol (MCP).
:page-topic-type: tutorial
:personas: ai_agent_developer, streaming_developer, evaluator
// Reader journey: "I want to try it now"
// Learning objectives - what readers will achieve by completing this quickstart:
:learning-objective-1: Create an MCP server in Redpanda Cloud
:learning-objective-2: Define tools that generate and publish data
:learning-objective-3: Connect Claude Code to your MCP server and invoke tools

This quickstart builds an MCP server in Redpanda Cloud that exposes tools for generating and publishing event data. You'll create two tools, then ask Claude Code to use them through natural language:

> Generate 10 user events and publish them to the events topic.

By completing this quickstart, you will be able to:

* [ ] {learning-objective-1}
* [ ] {learning-objective-2}
* [ ] {learning-objective-3}

TIP: For background on how MCP tools work and when to use each component type, see xref:ai-agents:mcp/remote/concepts.adoc[].

== Prerequisites

* A Redpanda Cloud cluster with *Remote MCP* enabled.
* Access to the xref:develop:connect/configuration/secret-management.adoc[Secrets Store] for storing credentials.
* At least version 25.2.5 of the xref:manage:rpk/rpk-install.adoc[Redpanda CLI (`rpk`)] installed on your computer.
* link:https://docs.anthropic.com/en/docs/claude-code/setup[Claude Code] installed.

== Prepare your cluster

Before creating the MCP server, you need to set up a topic for event publishing.

[tabs]
======
rpk::
+
--
. Log in to your Redpanda Cloud account:
+
[,bash]
----
rpk cloud login
----
+
This opens a browser window to authenticate. The token is saved locally inside your `rpk` configuration file. It is valid for 4 hours. You can refresh it by running `rpk cloud login` again.

. Create a topic called `events` for storing user event data:
+
[,bash]
----
rpk topic create events --partitions 3 --replicas 3
----

. Create a user called `mcp` with a strong password:
+
[,bash]
----
rpk acl user create mcp --password <your-secure-password>
----
+
Save the password securely. You need it later when configuring the MCP server.

. Grant the `mcp` user permissions to produce and consume from the `events` topic:
+
[,bash]
----
rpk acl create --allow-principal User:mcp --operation all --topic events
----
--

Data Plane API::
+
--
. link:/api/doc/cloud-controlplane/authentication#topic-request-an-access-token[Authenticate to the Control Plane API] to get an access token.
+
[NOTE]
====
Access tokens expire after 1 hour. To refresh, make the same authentication request again with your service account credentials. The same token works for both Control Plane and Data Plane API requests.
====

. Get the Data Plane API URL for your cluster:
+
[tabs]
====
BYOC or Dedicated::
+
Make a request to the link:/api/doc/cloud-controlplane/operation/operation-clusterservice_getcluster[`GET /v1/clusters/\{id}`] endpoint:
+
[,bash,role="no-placeholders"]
----
curl "https://api.redpanda.com/v1/clusters/<cluster-id>" \
  -H "Authorization: Bearer <control-plane-token>"
----

Serverless::
+
Make a request to the link:/api/doc/cloud-controlplane/operation/operation-serverlessclusterservice_getserverlesscluster[`GET /v1/serverless/clusters/\{id}`] endpoint:
+
[,bash]
----
curl "https://api.redpanda.com/v1/serverless/clusters/<cluster-id>" \
  -H "Authorization: Bearer <control-plane-token>"
----
====
+
The response includes a `dataplane_api.url` value:
+
[.no-copy]
----
  "id": "....",
  "name": "my-cluster",
....
  "dataplane_api": {
    "url": "https://api-xyz.abc.fmc.ppd.cloud.redpanda.com"
  },
...
----
+
[NOTE]
====
The `dataplane_api.url` field might not be immediately available when a cluster reaches STATE_READY. If the field is missing or null, wait a few minutes and make the request again. The Data Plane API URL is typically available within 5-10 minutes after cluster creation completes.
====

. Make a request to link:/api/doc/cloud-dataplane/operation/operation-topicservice_createtopic[`POST /v1/topics`] to create the topic:
+
[,bash]
----
curl -X POST "https://<dataplane-api-url>/v1/topics" \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "events",
    "partition_count": 3,
    "replication_factor": 3
  }'
----

. Make a request to link:/api/doc/cloud-dataplane/operation/operation-userservice_createuser[`POST /v1/users`] to create a user called `mcp`:
+
[,bash]
----
curl -X POST "https://<dataplane-api-url>/v1/users" \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "mcp",
    "password": "<your-secure-password>",
    "mechanism": "SASL_MECHANISM_SCRAM_SHA_256"
  }'
----
+
Save the password securely. You need it later when configuring the MCP server.

. Make a request to link:/api/doc/cloud-dataplane/operation/operation-aclservice_createacl[`POST /v1/acls`] to grant the `mcp` user permissions to produce and consume from the `events` topic:
+
[,bash]
----
curl -X POST "https://<dataplane-api-url>/v1/acls" \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{
    "resource_type": "RESOURCE_TYPE_TOPIC",
    "resource_name": "events",
    "resource_pattern_type": "RESOURCE_PATTERN_TYPE_LITERAL",
    "principal": "User:mcp",
    "host": "*",
    "operation": "OPERATION_ALL",
    "permission_type": "PERMISSION_TYPE_ALLOW"
  }'
----
--
======

== Create an MCP Server in Redpanda Cloud

[tabs]
=====
Cloud Console::
+
--
. Log in to the link:https://cloud.redpanda.com/[Redpanda Cloud Console^].

. Navigate to *Remote MCP*.
+
This page shows a list of existing servers.

. Click *Create new MCP Server*. In *Server Metadata*, configure the basic information and resources:
+
* *Display Name*: A human-friendly name such as `event-data-generator`. This name is shown in the Redpanda Cloud Console. It is not the name of the MCP server itself.
* *Description*: Explain what the server does. For example, `Generates fake user event data and publishes it to Redpanda topics`.
* *Tags*: Add key/value tags such as `owner=platform` or `env=demo`. The tag names `service_account_id` and `secret_id` are reserved and cannot be used.
* *Resources*: Choose a size (XSmall / Small / Medium / Large / XLarge). Larger sizes allow more concurrent requests and faster processing, but cost more. You can change this later.
* *Service Account*: A service account is automatically created for authenticating the MCP server to your cluster. The name is pre-filled. You can customize this name or keep the default.
+
[NOTE]
====
Service accounts authenticate MCP server requests to your Redpanda cluster. The service account has editor permissions to the cluster, allowing it to perform operations like reading and writing data, managing topics, and accessing cluster resources. Service account credentials are stored in the xref:develop:connect/configuration/secret-management.adoc[Secrets Store] with the ID `SERVICE_ACCOUNT_<mcp-server-id>` and scope set to *MCP server*.
====

. Click *Next* to define tools.
+
Tools define the actions your MCP server can perform. In this example, you create two tools: one for generating user event data and another for publishing that data to Redpanda.

. From the *Template* dropdown, select *Generate Input*.
+
The template populates the configuration with YAML for the tool definition.

. Click *Add Tool* to create a second tool.

. From the *Template* dropdown, select *Redpanda Output*.
+
The template populates the configuration for publishing to Redpanda and a section for adding the required secrets is displayed.

. Enter the values for the `mcp` user's credentials in the *Add Required Secrets* section.

. Click *Lint* to check the configuration. You should see no errors.

. Click *Create MCP Server* to deploy the server.
+
It may take a few seconds to start. The status changes from *Starting* to *Running* when it's ready.

. Open the *MCP Inspector* tab to test the tools:
+
* For the `generate_input` tool, click *Run Tool* to generate sample event data.
* For the `redpanda_output` tool, enter some sample event data such as `user_id=user123`, `event_type=login`, and `timestamp=2025-10-21T10:30:00Z` then click *Run Tool* to publish it to the `events` topic.
--

Data Plane API::
+
--
. Create a secret for the username:
+
[,bash]
----
curl -X POST "https://<dataplane-api-url>/v1/secrets" \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{
    "id": "MCP_USERNAME",
    "scopes": ["SCOPE_MCP_SERVER"],
    "secret_data": "bWNw"
  }'
----
+
The `secret_data` value `bWNw` is the base64-encoded string `mcp`.
+
Create a secret for the password:
+
[,bash]
----
curl -X POST "https://<dataplane-api-url>/v1/secrets" \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{
    "id": "MCP_PASSWORD",
    "scopes": ["SCOPE_MCP_SERVER"],
    "secret_data": "<base64-encoded-password>"
  }'
----
+
Replace `<base64-encoded-password>` with your password encoded in base64. You can encode it with: `echo -n '<your-secure-password>' | base64`.

. Using the Data Plane API URL from the previous section, make a request to link:/api/doc/cloud-dataplane/operation/operation-mcpserverservice_createmcpserver[`POST /v1/redpanda-connect/mcp-servers`] to create the MCP server:
+
[,bash]
----
curl -X POST "https://<dataplane-api-url>/v1/redpanda-connect/mcp-servers" \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{
    "display_name": "event-data-generator",
    "description": "Generates fake user event data and publishes it to Redpanda topics",
    "tags": {
      "owner": "platform",
      "env": "demo"
    },
    "resources": {
      "memory_shares": "400M",
      "cpu_shares": "100m"
    },
    "tools": {
      "generate_input": {
        "component_type": "COMPONENT_TYPE_INPUT",
        "config_yaml": "generate:\n  interval: 1s\n  mapping: |\n    root.user_id = \"user\" + random_int(min: 1, max: 1000).string()\n    root.event_type = [\"login\", \"logout\", \"purchase\", \"view\"].index(random_int(max: 3))\n    root.timestamp = now().ts_format(\"2006-01-02T15:04:05Z07:00\")"
      },
      "redpanda_output": {
        "component_type": "COMPONENT_TYPE_OUTPUT",
        "config_yaml": "redpanda:\n  seed_brokers: [ \"${REDPANDA_BROKERS}\" ]\n  topic: events\n  tls:\n    enabled: true\n  sasl:\n    - mechanism: SCRAM-SHA-256\n      username: \"${secrets.MCP_USERNAME}\"\n      password: \"${secrets.MCP_PASSWORD}\"\n"
      }
    }
  }'
----
+
The response includes the MCP server ID. Wait for the status to show *Running* before testing the tools.

. To test the tools, use the link:/api/doc/cloud-dataplane/operation/operation-mcpserverservice_getmcpserver[`GET /v1/redpanda-connect/mcp-servers/\{mcp_server_id}`] endpoint to verify the server is running.
--
=====

== Connect an AI client

Now that your MCP server is running with two tools available, you'll connect Claude Code so it can discover and use them. You can connect any MCP-compatible AI client to your MCP server.

When you connect Claude Code:

. Claude automatically discovers your `generate_input` and `redpanda_output` tools
. You can ask Claude in natural language to perform tasks using these tools
. Claude decides which tools to call and in what order based on your request
. The Redpanda CLI acts as a secure proxy, forwarding Claude's tool requests to your MCP server in the cloud

This example uses Claude Code, but the same pattern works with any MCP-compatible client.

. Log in to your Redpanda Cloud account:
+
[,bash]
----
rpk cloud login
----
+
This opens a browser window to authenticate. The token is saved locally inside your `rpk` configuration file. It is valid for 4 hours. You can refresh it by running `rpk cloud login` again.

. Open the *Connection* tab in Redpanda Cloud to get connection details and run the `rpk` command for Claude Code.
+
For BYOC and Dedicated clusters, use:
+
[,bash]
----
rpk cloud mcp proxy \
--cluster-id <cluster-id> \
--mcp-server-id <server-id> \
--install --client claude-code
----
+
For Serverless clusters, use:
+
[,bash]
----
rpk cloud mcp proxy \
--serverless-cluster-id <cluster-id> \
--mcp-server-id <server-id> \
--install --client claude-code
----

. Restart Claude Code and invoke your tool.
+
[,bash]
----
claude
----

. Ask Claude Code to use your tools. Try these example requests:
+
* "Generate 10 user events and then publish them to the events topic."
* "Create sample login events for users user001, user002, and user003, then publish them to Redpanda."
* "Generate purchase events with metadata and publish them to the events topic."
+
Watch what happens:
+
--
* Claude analyzes your natural language request
* Claude identifies which tools to use (`generate_input` to create data, `redpanda_output` to publish)
* Claude calls your tools via the MCP server running in Redpanda Cloud
* You see the tool execution results in your Claude Code session
--
+
You may need to respond to prompts to grant Claude permission to call the tools.

. Verify the events were published by consuming from the `events` topic:
+
[,bash]
----
rpk topic consume events --num 10
----
+
You should see the generated event data in JSON format, confirming that Claude successfully used your custom tools to generate data and publish it to Redpanda.

== Summary

You extended Claude's capabilities with custom tools that interact with your Redpanda cluster. Claude can now generate and publish event data through natural language commands without manual scripting. This same pattern works for any workflow: reading from topics, transforming data, querying databases, or calling external APIs.

== Troubleshoot

If you encounter issues during this quickstart:

- **MCP server not starting**: Check the *Logs* tab and verify your YAML syntax by clicking *Lint*.
- **Connection issues**: Verify you're logged in with `rpk cloud login` and that your server status shows *Running*.
- **Publishing failures**: Verify the `events` topic exists with `rpk topic list`.

For detailed solutions, see xref:ai-agents:mcp/remote/troubleshooting.adoc[].

== Next steps

You've deployed an MCP server and connected Claude Code to your Redpanda cluster. Here's where to go next:

* xref:ai-agents:mcp/remote/concepts.adoc[]: Understand how MCP tools differ from pipelines
* xref:ai-agents:mcp/remote/create-tool.adoc[]: Build production-quality tools with validation
* xref:ai-agents:mcp/remote/best-practices.adoc[]: Apply naming and design guidelines
* xref:ai-agents:mcp/remote/tool-patterns.adoc[]: Find reusable patterns
* xref:ai-agents:mcp/remote/troubleshooting.adoc[]: Diagnose common issues
* xref:ai-agents:mcp/remote/admin-guide.adoc[]: Scale resources, monitor activity, and administer your MCP servers
