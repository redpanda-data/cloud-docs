= MCP Tool Patterns
:page-aliases: ai-agents:mcp/remote/pipeline-patterns.adoc
:description: Catalog of patterns for MCP server tools in Redpanda Cloud.
:page-topic-type: cookbook
:personas: ai_agent_developer, data_engineer
// Reader journey: "I need an example for X"
:learning-objective-1: Find reusable patterns for common MCP tool scenarios
:learning-objective-2: Apply validation and error handling patterns for production robustness
:learning-objective-3: Format responses consistently for AI client consumption

When building tools, use these patterns as starting points for common scenarios. For step-by-step instructions, see xref:ai-agents:mcp/remote/create-tool.adoc[]. For design guidelines, see xref:ai-agents:mcp/remote/best-practices.adoc[].

After reading this page, you will be able to:

* [ ] {learning-objective-1}
* [ ] {learning-objective-2}
* [ ] {learning-objective-3}

[[read-data]]
== Read data

Use xref:develop:connect/components/inputs/about.adoc[inputs] to create tools that read from data sources or generate sample data.

[[data-generators]]
=== Generate test data

*When to use:* Development and testing environments where you need synthetic data, load testing scenarios, or demonstrating data flows without real data sources.

*Example use cases:* Mock user events, test order data, synthetic sensor readings, demo data for presentations.

[source,yaml]
----
include::ai-agents:example$mcp-tools/inputs/generate_input.yaml[]
----

See also: xref:develop:connect/components/inputs/generate.adoc[`generate` input component]

[[consume-from-redpanda]]
=== Consume from Redpanda topics

*When to use:* Processing events from Redpanda topics, building event-driven AI agents, consuming audit logs, or subscribing to data change streams.

*Example use cases:* Monitor order events, process user activity streams, consume IoT sensor data, react to system notifications.

[source,yaml]
----
include::ai-agents:example$mcp-tools/inputs/consume_redpanda.yaml[tag=component,indent=0]
----

See also: xref:develop:connect/components/inputs/redpanda.adoc[`redpanda` input]

[[stream-processing]]
=== Process streaming data

*When to use:* Real-time analytics, windowed aggregations, computing metrics over time, or building streaming dashboards.

*Example use cases:* Calculate rolling averages, count events per time window, detect anomalies in streams, aggregate metrics.

[source,yaml]
----
include::ai-agents:example$mcp-tools/inputs/stream_processing.yaml[tag=component,indent=0]
----

See also: xref:develop:connect/components/inputs/redpanda.adoc[`redpanda` input]

[[call-external-services]]
== Call external services

Use xref:develop:connect/components/processors/about.adoc[processors] to fetch data from external APIs, databases, or AI services.

[[external-api-calls]]
=== Call REST APIs

*When to use:* Integrating with third-party services, fetching real-time data, calling internal microservices, or enriching event data with external information.

*Example use cases:* Fetch user profile from CRM, get product pricing from inventory API, validate addresses with geocoding service, retrieve weather data.

[source,yaml]
----
include::ai-agents:example$mcp-tools/processors/http_processor.yaml[]
----

See also: xref:develop:connect/components/processors/http.adoc[`http` processor], xref:develop:connect/components/processors/mutation.adoc[`mutation` processor]

[[database-queries]]
=== Query databases

*When to use:* Retrieving customer records, querying analytics data, looking up configuration values, or joining streaming data with dimensional data from data warehouses.

*Example use cases:* Fetch customer details from PostgreSQL, query sales data from BigQuery, retrieve product catalog from MongoDB, look up reference data.

[source,yaml]
----
include::ai-agents:example$mcp-tools/processors/gcp_bigquery_select_processor.yaml[]
----

See also: xref:develop:connect/components/processors/gcp_bigquery_select.adoc[`gcp_bigquery_select` processor], xref:develop:connect/components/processors/sql_select.adoc[`sql_select` processor]

[[jira-queries]]
=== Query Jira issues

*When to use:* Fetching tickets by status, checking assignments, finding recent issues, or building AI agents that interact with project management data.

*Example use cases:* Get open bugs for a sprint, find issues assigned to a user, list recently updated tickets, search by custom fields.

NOTE: The `jira` processor is available on Dedicated and BYOC clusters.

[source,yaml]
----
include::ai-agents:example$mcp-tools/processors/search_jira.yaml[tag=complete,indent=0]
----

For more patterns including pagination, custom fields, and creating issues via the HTTP processor, see xref:develop:connect/cookbooks/jira.adoc[].

[[ai-llm-integration]]
=== Integrate with AI/LLM services

*When to use:* Generating embeddings for semantic search, calling LLM APIs for text generation, building RAG pipelines, or analyzing sentiment.

*Example use cases:* Generate embeddings for documents, classify customer feedback, summarize long text, extract entities, answer questions with context.

==== OpenAI chat completion

[source,yaml]
----
include::ai-agents:example$mcp-tools/processors/openai_chat.yaml[tag=component,indent=0]
----

See also: xref:develop:connect/components/processors/openai_chat_completion.adoc[`openai_chat_completion`], xref:develop:connect/components/processors/openai_embeddings.adoc[`openai_embeddings`]

==== Generate embeddings

[source,yaml]
----
include::ai-agents:example$mcp-tools/processors/openai_embeddings.yaml[tag=component,indent=0]
----

See also: xref:develop:connect/components/processors/cohere_embeddings.adoc[`cohere_embeddings`], xref:develop:connect/components/processors/gcp_vertex_ai_embeddings.adoc[`gcp_vertex_ai_embeddings`]

[[write-data]]
== Write data

Use xref:develop:connect/components/outputs/about.adoc[outputs] to write data to Redpanda topics or cache stores.

[[publish-to-redpanda]]
=== Publish to Redpanda topics

*When to use:* Publishing events to Redpanda for consumption by other services, creating event sourcing patterns, building audit trails, or triggering downstream workflows.

*Example use cases:* Publish order confirmations, emit audit events, trigger notifications, create event-driven workflows.

[source,yaml]
----
include::ai-agents:example$mcp-tools/outputs/redpanda_output.yaml[]
----

See also: xref:develop:connect/components/outputs/redpanda.adoc[`redpanda` output]

==== Outputs with processors

Output tools can include processors to transform data before publishing. This pattern is useful when you need to process data and save the result to a destination in a single tool.

*When to use:* Processing user input with an LLM and saving the response, transforming data before publishing to a topic, enriching events before writing to external systems.

[source,yaml]
----
include::ai-agents:example$mcp-tools/outputs/redpanda_output_with_processors.yaml[]
----

[[caching]]
=== Cache data

*When to use:* Reducing repeated API calls, storing lookup tables, caching database query results, or maintaining session state across tool invocations.

*Example use cases:* Cache user profiles, store API rate limit counters, maintain configuration values, cache product catalogs.

.Redpanda-backed cache
[source,yaml]
----
include::ai-agents:example$mcp-tools/caches/redpanda_cache.yaml[]
----

.In-memory cache
[source,yaml]
----
include::ai-agents:example$mcp-tools/caches/memory_cache.yaml[]
----

See also: xref:develop:connect/components/caches/memory.adoc[`memory` cache], xref:develop:connect/components/outputs/redpanda.adoc[`redpanda` output]

[[transform-data]]
== Transform data

Use Bloblang and processors to transform, validate, and route data.

[[data-transformation]]
=== Transform and validate

*When to use:* Converting data formats, validating schemas, filtering events, enriching messages with computed fields, or normalizing data structures.

*Example use cases:* Parse JSON payloads, validate required fields, add timestamps, convert units, mask sensitive data, aggregate nested objects.

[source,yaml]
----
include::ai-agents:example$mcp-tools/processors/transform_validate.yaml[tag=mapping,indent=0]
----

See also: xref:develop:connect/components/processors/mapping.adoc[`mapping` processor], xref:develop:connect/guides/bloblang/about.adoc[Bloblang guide]

[[event-driven-workflows]]
=== Build event-driven workflows

*When to use:* Orchestrating multi-step processes, responding to business events, implementing saga patterns, or coordinating microservices.

*Example use cases:* Order fulfillment workflows, approval processes, notification cascades, data pipeline orchestration.

[source,yaml]
----
include::ai-agents:example$mcp-tools/inputs/event_driven_workflow.yaml[tag=component,indent=0]
----

See also: xref:develop:connect/components/inputs/redpanda.adoc[`redpanda` input]

[[production-readiness]]
== Production readiness

Build production-ready tools with proper input validation, error handling, and response formatting.

[[input-validation]]
=== Validate input

AI clients may send unexpected or malformed input. Validate early to return helpful error messages instead of cryptic failures from downstream components.

include::redpanda-connect:ai-agents:partial$mcp/tool-patterns/input-validation.adoc[leveloffset=+1]

[[error-handling]]
=== Handle errors

External services fail. Databases go down. APIs return unexpected responses. Wrap risky operations in error handling so your tool returns useful error messages instead of crashing.

include::redpanda-connect:ai-agents:partial$mcp/tool-patterns/error-handling.adoc[leveloffset=+1]

[[response-formatting]]
=== Format responses

AI clients work best with clean, predictable response structures. Transform raw component output into consistent formats.

include::redpanda-connect:ai-agents:partial$mcp/tool-patterns/response-formatting.adoc[leveloffset=+1]

// Production workflows section - single-sourced from rp-connect-docs
include::redpanda-connect:ai-agents:partial$mcp/tool-patterns/production-workflows.adoc[]

== Next steps

* xref:ai-agents:agents/integration-overview.adoc[]: Choose between agents invoking MCP tools and pipelines calling agents
* xref:ai-agents:mcp/remote/create-tool.adoc[]: Step-by-step tool creation guide
* xref:ai-agents:mcp/remote/best-practices.adoc[]: Apply naming and design guidelines
* xref:ai-agents:mcp/remote/troubleshooting.adoc[]: Diagnose and fix common issues
