= Create an MCP Tool
:description: Create an MCP tool with the correct YAML structure, metadata, and parameter mapping.
:page-topic-type: how-to
:personas: agent_developer, streaming_developer, data_engineer
// Reader journey: "I want to create a tool for my AI agent"
// Learning objectives - what readers can do after reading this page:
:learning-objective-1: Create a tool with the correct structure and MCP metadata
:learning-objective-2: Map MCP parameters to component configuration fields using Bloblang
:learning-objective-3: Test tools using the MCP Inspector

After xref:ai-agents:mcp/remote/quickstart.adoc[deploying your first MCP server], create custom tools that AI clients can discover and invoke. This guide walks you through the process using any Redpanda Connect component.

After reading this page, you will be able to:

* [ ] {learning-objective-1}
* [ ] {learning-objective-2}
* [ ] {learning-objective-3}

== Prerequisites

* A Redpanda Cloud cluster with *Remote MCP* enabled.
* You can describe the MCP execution model (see xref:ai-agents:mcp/remote/concepts.adoc#execution-model[The MCP execution model])
* You have chosen the right component type for your use case (see xref:ai-agents:mcp/remote/concepts.adoc#component-selection[Choose the right component type])

== Create the tool

In Redpanda Cloud, you create tools directly in the Cloud Console or using the Data Plane API.

[tabs]
======
Cloud Console::
+
--
. Log in to the link:https://cloud.redpanda.com/[Redpanda Cloud Console^].

. Navigate to *Agentic AI* > *Remote MCP* and either create a new MCP server or edit an existing one.

. In the *Tools* section, click *Add Tool*.

. Enter the YAML configuration for your tool.

. Click *Lint* to validate your configuration.

. Click *Save* to deploy the tool.
--

Data Plane API::
+
--
Use the link:/api/doc/cloud-dataplane/operation/operation-mcpserverservice_createmcpserver[Create MCP Server] or link:/api/doc/cloud-dataplane/operation/operation-mcpserverservice_updatemcpserver[Update MCP Server] endpoints to add tools programmatically.
--
======

[[yaml-structure]]
== Add the tool structure

An MCP tool wraps a xref:develop:connect/components/about.adoc[Redpanda Connect component] and exposes it to AI clients. Each tool has three parts:

* **Label**: The tool name AI clients see
* **Component configuration**: A Redpanda Connect component (processor, input, output, or cache) that does the work
* **MCP metadata**: Describes the tool's purpose and parameters for AI clients

Here's an example using the xref:develop:connect/components/processors/sql_select.adoc[`sql_select` processor]:

[source,yaml]
----
include::ai-agents:example$mcp-tools/processors/lookup_customer.yaml[tag=complete,indent=0]
----

<1> **Label**: Becomes the tool name.
<2> **Component**: The `sql_select` processor configured to query a database.
<3> **MCP metadata**: Tells AI clients what this tool does and what parameters it accepts.

Each tool configuration must contain exactly one component. The component type is inferred from the type you select when creating or editing the MCP server. The component can be a processor, input, output, or cache.

The following sections show how to structure tools for each component type.

=== Label naming rules

include::redpanda-connect:ai-agents:partial$mcp/create-tool/label-naming-rules.adoc[]

=== Component types

xref:develop:connect/components/processors/about.adoc[Processors] transform, filter, or enrich data. Use a `processors:` array with one or more processors:

.Processor tool
[source,yaml]
----
include::ai-agents:example$mcp-tools/processors/enrich_order.yaml[tag=complete,indent=0]
----

xref:develop:connect/components/inputs/about.adoc[Inputs] read data from sources, xref:develop:connect/components/outputs/about.adoc[outputs] write data to destinations, and xref:develop:connect/components/caches/about.adoc[caches] store and retrieve data. Define these components directly at the top level:

.Input tool
[source,yaml]
----
include::ai-agents:example$mcp-tools/inputs/read_events.yaml[tag=complete,indent=0]
----
<1> The component name (`redpanda`) is at the top level, not wrapped in `input:`.

.Output tool
[source,yaml]
----
include::ai-agents:example$mcp-tools/outputs/publish_event.yaml[tag=complete,indent=0]
----

.Cache tool
[source,yaml]
----
include::ai-agents:example$mcp-tools/caches/session_cache.yaml[tag=complete,indent=0]
----

Outputs can include a `processors:` section to transform data before publishing:

.Output tool with processors
[source,yaml]
----
include::ai-agents:example$mcp-tools/outputs/publish_with_timestamp.yaml[tag=complete,indent=0]
----

See xref:ai-agents:mcp/remote/tool-patterns.adoc#outputs-with-processors[outputs with processors] for more examples.

Do not wrap components in `input:`, `output:`, or `cache:` blocks. This syntax is for pipelines, not MCP tools.

[[mcp-metadata]]
=== MCP metadata fields

The `meta.mcp` block defines how AI clients discover and interact with your tool. These fields control tool visibility, naming, and input parameters.

include::redpanda-connect:ai-agents:partial$mcp/create-tool/mcp-metadata-fields-table.adoc[]

[#mcp-property-fields]
==== Property fields

include::redpanda-connect:ai-agents:partial$mcp/create-tool/property-fields-table.adoc[]

[[property-restrictions]]
==== Property restrictions by component type

include::redpanda-connect:ai-agents:partial$mcp/create-tool/property-restrictions-table.adoc[]

[[parameter-mapping]]
== Map parameters to component fields

When an AI client calls your tool, the `arguments` object becomes the message body. You can access these arguments using xref:develop:connect/guides/bloblang/about.adoc[Bloblang], but the syntax depends on where you're using it:

* **Inside Bloblang contexts** (mutation, mapping, args_mapping): Use `this.field_name`
* **Inside string fields** (URLs, topics, headers): Use interpolation `${! json("field_name") }`

=== In Bloblang contexts

Use `this` to access message fields directly in processors like `mutation`, `mapping`, or in `args_mapping` fields:

[source,yaml]
----
include::ai-agents:example$mcp-tools/snippets/bloblang_this_context.yaml[tag=mutation,indent=0]
----

[source,yaml]
----
include::ai-agents:example$mcp-tools/snippets/bloblang_this_context.yaml[tag=args_mapping,indent=0]
----

=== In string fields (interpolation)

Use `${! ... }` interpolation to embed Bloblang expressions inside string values like URLs or topic names:

[source,yaml]
----
include::ai-agents:example$mcp-tools/snippets/interpolation.yaml[tag=http_url,indent=0]
----

[source,yaml]
----
include::ai-agents:example$mcp-tools/snippets/interpolation.yaml[tag=redpanda_topic,indent=0]
----
<1> `$\{VAR}` without `!` is environment variable substitution, not Bloblang.
<2> `${! ... }` with `!` is Bloblang interpolation that accesses message data.

TIP: For more on Bloblang syntax, see xref:develop:connect/guides/bloblang/about.adoc[]. For interpolation details, see xref:develop:connect/configuration/interpolation.adoc[].

=== Provide defaults for optional parameters

Use `.or(default)` to handle missing optional parameters:

[source,yaml]
----
include::ai-agents:example$mcp-tools/snippets/defaults.yaml[tag=mutation,indent=0]
----

Declare which parameters are required in your `meta.mcp.properties`:

[source,yaml]
----
include::ai-agents:example$mcp-tools/snippets/defaults.yaml[tag=properties,indent=0]
----

[[secrets]]
== Use the Secrets Store

Never hardcode credentials, API keys, or connection strings in your tool configurations. Use the xref:develop:connect/configuration/secret-management.adoc[Secrets Store] to securely manage sensitive values.

Reference secrets using `${secrets.SECRET_NAME}` syntax:

[source,yaml]
----
include::ai-agents:example$mcp-tools/snippets/secrets.yaml[tag=example,indent=0]
----

When you add secret references to your tool configuration, the Cloud Console automatically detects them and provides an interface to create the required secrets.

=== Secrets best practices

* Use uppercase snake_case for secret names (for example, `DATAPLANE_TOKEN`, `API_KEY`).
* Rotate secrets periodically.
* Follow the principle of least privilege. Only request the scopes and roles your tool actually needs.

See xref:ai-agents:mcp/remote/best-practices.adoc#secrets[Secrets management] for more guidance.

== Test the tool

. Click *Lint* to validate your configuration.

. Deploy the MCP server.

. Use the *MCP Inspector* tab to test tool calls:
+
* Select the tool from the list
* Enter test parameter values
* Click *Run Tool* to execute
* Review the response

. Connect an AI client and verify the tool appears:
+
[,bash]
----
rpk cloud mcp proxy \
  --cluster-id <cluster-id> \
  --mcp-server-id <server-id> \
  --install --client claude-code
----

. Test end-to-end with realistic prompts to verify the AI client uses your tool correctly.

== Complete example

Here's a complete tool that wraps the `http` processor to fetch weather data:

[source,yaml]
----
include::ai-agents:example$mcp-tools/processors/get_weather_complete.yaml[tag=complete,indent=0]
----

== Next steps

* xref:ai-agents:agents/quickstart.adoc[]
* xref:ai-agents:mcp/remote/best-practices.adoc[]
* xref:ai-agents:mcp/remote/tool-patterns.adoc[]
* xref:ai-agents:mcp/remote/troubleshooting.adoc[]
* xref:develop:connect/components/about.adoc[]
